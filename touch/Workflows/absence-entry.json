{
  "key": "absence-entry",
  "flow": "sys-flows",
  "domain": "touch",
  "version": "1.0.0",
  "tags": [
    "new"
  ],
  "attributes": {
    "type": "S",
    "labels": [
      {
        "label": "Absence Entry",
        "language": "en-US"
      },
      {
        "label": "Yokluk Kaydı",
        "language": "tr-TR"
      }
    ],
    "functions": [],
    "features": [],
    "extensions": [],
    "sharedTransitions": [
      {
        "key": "cancel",
        "target": "cancelled",
        "triggerType": 0,
        "versionStrategy": "Minor",
        "availableIn": [
          "draft",
          "scheduled",
          "active"
        ],
        "labels": [
          {
            "label": "Cancel",
            "language": "en-US"
          },
          {
            "label": "İptal Et",
            "language": "tr-TR"
          }
        ]
      }
    ],
    "startTransition": {
      "key": "start",
      "target": "draft",
      "versionStrategy": "Major",
      "triggerType": 0,
      "labels": [
        {
          "label": "Start",
          "language": "en-US"
        },
        {
          "label": "Başla",
          "language": "tr-TR"
        }
      ]
    },
    "states": [
      {
        "key": "draft",
        "stateType": 1,
        "versionStrategy": "Minor",
        "labels": [
          {
            "label": "Draft",
            "language": "en-US"
          },
          {
            "label": "Taslak",
            "language": "tr-TR"
          }
        ],
        "transitions": [
          {
            "key": "schedule",
            "target": "scheduled",
            "triggerType": 0,
            "versionStrategy": "Minor",
            "labels": [
              {
                "label": "Schedule",
                "language": "en-US"
              },
              {
                "label": "Planla",
                "language": "tr-TR"
              }
            ],
            "_comment": "Used for personal-leave and public-holiday types with future dates"
          },
          {
            "key": "activate",
            "target": "active",
            "triggerType": 0,
            "versionStrategy": "Minor",
            "labels": [
              {
                "label": "Activate",
                "language": "en-US"
              },
              {
                "label": "Aktifleştir",
                "language": "tr-TR"
              }
            ],
            "_comment": "Used for working-hours-change type to activate custom working hours immediately"
          }
        ]
      },
      {
        "key": "scheduled",
        "stateType": 2,
        "versionStrategy": "Minor",
        "labels": [
          {
            "label": "Scheduled",
            "language": "en-US"
          },
          {
            "label": "Planlandı",
            "language": "tr-TR"
          }
        ],
        "transitions": [
          {
            "key": "update",
            "target": "scheduled",
            "triggerType": 0,
            "versionStrategy": "Minor",
            "labels": [
              {
                "label": "Update",
                "language": "en-US"
              },
              {
                "label": "Güncelle",
                "language": "tr-TR"
              }
            ]
          },
          {
            "key": "complete",
            "target": "completed",
            "triggerType": 1,
            "versionStrategy": "Minor",
            "labels": [
              {
                "label": "Complete",
                "language": "en-US"
              },
              {
                "label": "Tamamla",
                "language": "tr-TR"
              }
            ],
            "rule": {
              "type": "expression",
              "expression": {
                "or": [
                  {
                    "and": [
                      {"eq": ["$.attributes.entryMode", "full-day"]},
                      {"lt": ["$.attributes.endDate", "$now"]}
                    ]
                  },
                  {
                    "and": [
                      {"eq": ["$.attributes.entryMode", "time-range"]},
                      {"lt": ["$.attributes.endDateTime", "$now"]}
                    ]
                  }
                ]
              },
              "description": "Auto-triggered when the absence end date/time has passed"
            }
          }
        ],
        "_comment": "These entries are used to calculate appointment availability. Records in this state are considered unavailable for appointments."
      },
      {
        "key": "active",
        "stateType": 2,
        "versionStrategy": "Minor",
        "labels": [
          {
            "label": "Active",
            "language": "en-US"
          },
          {
            "label": "Aktif",
            "language": "tr-TR"
          }
        ],
        "transitions": [
          {
            "key": "update",
            "target": "active",
            "triggerType": 0,
            "versionStrategy": "Minor",
            "labels": [
              {
                "label": "Update",
                "language": "en-US"
              },
              {
                "label": "Güncelle",
                "language": "tr-TR"
              }
            ],
            "_comment": "Used to update working hours configuration"
          },
          {
            "key": "expire",
            "target": "expired",
            "triggerType": 1,
            "versionStrategy": "Minor",
            "labels": [
              {
                "label": "Expire",
                "language": "en-US"
              },
              {
                "label": "Süresi Dol",
                "language": "tr-TR"
              }
            ],
            "rule": {
              "type": "expression",
              "expression": {
                "and": [
                  {"ne": ["$.attributes.customWorkingHours.effectiveTo", null]},
                  {"lt": ["$.attributes.customWorkingHours.effectiveTo", "$now"]}
                ]
              },
              "description": "Auto-triggered when effectiveTo date is reached for temporary working hours changes. Permanent changes (effectiveTo=null) never expire."
            }
          }
        ],
        "_comment": "Active state for working-hours-change type. Custom working hours are effective while in this state."
      },
      {
        "key": "completed",
        "stateType": 3,
        "versionStrategy": "Minor",
        "labels": [
          {
            "label": "Completed",
            "language": "en-US"
          },
          {
            "label": "Tamamlandı",
            "language": "tr-TR"
          }
        ],
        "_comment": "Final state when absence period has ended normally"
      },
      {
        "key": "expired",
        "stateType": 3,
        "versionStrategy": "Minor",
        "labels": [
          {
            "label": "Expired",
            "language": "en-US"
          },
          {
            "label": "Süresi Doldu",
            "language": "tr-TR"
          }
        ],
        "_comment": "Final state for temporary working hours changes that have expired"
      },
      {
        "key": "cancelled",
        "stateType": 3,
        "versionStrategy": "Minor",
        "labels": [
          {
            "label": "Cancelled",
            "language": "en-US"
          },
          {
            "label": "İptal Edildi",
            "language": "tr-TR"
          }
        ]
      }
    ],
    "subFlowType": "S",
    "timeout": null
  }
}
